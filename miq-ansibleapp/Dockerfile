FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.ansibleapp.version"="0.1.0"
LABEL "com.redhat.ansibleapp.spec"=\
"aWQ6IDcwZWJkOGEzLTI3ZDktNGFkYy1iM2QzLWMxYzQxYzU5MWU1NgpuYW1lOiBhbnNpYmxlYXBw\
L21pcS1hbnNpYmxlYXBwCmRlc2NyaXB0aW9uOiBNYW5hZ2VJUSBhbnNpYmxlYXBwIGltcGxlbWVu\
dGF0aW9uCmJpbmRhYmxlOiBmYWxzZQphc3luYzogb3B0aW9uYWwKcGFyYW1ldGVyczoKICAtIG5h\
bWU6IGFwcGxpY2F0aW9uX2luaXRfZGVsYXkKICAgIGRlc2NyaXB0aW9uOiBUaW1lIHRvIGRlbGF5\
IHdlYiBhcHAgc3RhcnR1cAogICAgdHlwZTogaW50CiAgICBkZWZhdWx0OiA2MAogIC0gbmFtZTog\
ZGF0YWJhc2VfcmVnaW9uCiAgICBkZXNjcmlwdGlvbjogTUlRIEluc3RhbmNlIFJlZ2lvbgogICAg\
dHlwZTogaW50CiAgICBkZWZhdWx0OiAxCiAgLSBuYW1lOiBkYXRhYmFzZV9zZXJ2aWNlX25hbWUK\
ICAgIGRlc2NyaXB0aW9uOiBTZXJ2aWNlIE5hbWUgZm9yIHRoZSBkYXRhYmFzZQogICAgdHlwZTog\
c3RyaW5nCiAgICBkZWZhdWx0OiBtaXEtcG9zdGdyZXNxbAogIC0gbmFtZTogbWVtY2FjaGVkX21h\
eF9jb25uZWN0aW9ucwogICAgZGVzY3JpcHRpb246IE1heGltdW0gbnVtYmVyIG9mIGNvbm5lY3Rp\
b25zIG1lbWNhY2hlZCB3aWxsIGFjY2VwdAogICAgdHlwZTogaW50CiAgICBkZWZhdWx0OiAxMDI0\
CiAgLSBuYW1lOiBtZW1jYWNoZWRfbWF4X21lbW9yeQogICAgZGVzY3JpcHRpb246IE1heGltdW0g\
bWVtb3J5IG1lbWNhY2hlZCB3aWxsIHVzZSBpbiBNQgogICAgdHlwZTogaW50CiAgICBkZWZhdWx0\
OiA2NAogIC0gbmFtZTogbWVtY2FjaGVkX3NsYWJfcGFnZV9zaXplCiAgICBkZXNjcmlwdGlvbjog\
TWVtY2FjaGVkIFNsYWIgU2l6ZQogICAgdHlwZTogc3RyaW5nCiAgICBkZWZhdWx0OiAxbWIKICAt\
IG5hbWU6IG1lbWNhY2hlZF9zZXJ2aWNlX25hbWUgCiAgICBkZXNjcmlwdGlvbjogU2VydmljZSBu\
YW1lIG9mIHRoZSBtZW1jYWNoZWQgaW5zdGFuY2UgdG8gdXNlCiAgICB0eXBlOiBzdHJpbmcKICAg\
IGRlZmF1bHQ6IG1pcS1tZW1jYWNoZWQKICAtIG5hbWU6IG1pcV9tZW1jYWNoZWRfcG9ydAogICAg\
ZGVzY3JpcHRpb246IE1lbWNhY2hlZCBwb3J0CiAgICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1bHQ6\
ICJ0Y3A6Ly97eyBtZW1jYWNoZWRfc2VydmljZV9uYW1lIH19OjExMjExIgogIC0gbmFtZTogbWlx\
X3Bvc3RncmVzcWxfcG9ydAogICAgZGVzY3JpcHRpb246IFBvc3RncmVzcWwgcG9ydAogICAgdHlw\
ZTogc3RyaW5nCiAgICBkZWZhdWx0OiAidGNwOi8ve3sgZGF0YWJhc2Vfc2VydmljZV9uYW1lIH19\
OjU0MzIiCiAgLSBuYW1lOiBuYW1lc3BhY2UKICAgIGRlc2NyaXB0aW9uOiBOYW1lc3BhY2UgdG8g\
ZGVwbG95IHRoZSBjbHVzdGVyIHRvCiAgICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1bHQ6IG1pcS1h\
bnNpYmxlYXBwCiAgLSBuYW1lOiBwb3N0Z3Jlc3FsX2RhdGFiYXNlIAogICAgZGVzY3JpcHRpb246\
IHBvc3RncmVzcWwgZGF0YWJhc2UgbmFtZQogICAgdHlwZTogc3RyaW5nCiAgICBkZWZhdWx0OiB2\
bWRiX3Byb2R1Y3Rpb24KICAtIG5hbWU6IHBvc3RncmVzcWxfcGFzc3dvcmQKICAgIGRlc2NyaXB0\
aW9uOiBwb3N0Z3Jlc3FsIGRhdGFiYXNlIHBhc3N3b3JkCiAgICB0eXBlOiBzdHJpbmcKICAgIGRl\
ZmF1bHQ6IGFkbWluCiAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3VzZXIKICAgIGRlc2NyaXB0aW9uOiBw\
b3N0Z3Jlc3FsIGRhdGFiYXNlIHVzZXJuYW1lCiAgICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1bHQ6\
IGFkbWluCg=="
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN yum -y install epel-release centos-release-openshift-origin \
 && yum -y install origin

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
