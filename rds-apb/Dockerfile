FROM ansibleapp/ansibleapp-base
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.ansibleapp.version"="0.1.0"
LABEL "com.redhat.ansibleapp.spec"=\
"aWQ6IDg0ZTgxNzNlLTVjZWQtNDQ4OS05YjRkLWFhYzdlNzc5YzQ3ZQpuYW1lOiBhbnNpYmxlcGxh\
eWJvb2tidW5kbGUvcmRzLWFwYgpkZXNjcmlwdGlvbjogcmRzIGFwYiAKYmluZGFibGU6IHRydWUK\
YXN5bmM6IG9wdGlvbmFsCnBhcmFtZXRlcnM6CiAgLSBuYW1lOiBhd3NfYWNjZXNzX2tleQogICAg\
ZGVzY3JpcHRpb246IGF3cyBhY2Nlc3Mga2V5IHRvIGF1dGhlbnRpY2F0ZSB0byBhd3Mgd2l0aAog\
ICAgdHlwZTogc3RyaW5nCiAgLSBuYW1lOiBhd3Nfc2VjcmV0X2tleQogICAgZGVzY3JpcHRpb246\
IGF3cyBzZWNyZXQga2V5IHRvIGF1dGhlbnRpY2F0ZSB0byBhd3Mgd2l0aAogICAgdHlwZTogc3Ry\
aW5nCiAgLSBuYW1lOiBiYWNrdXBfcmV0ZW50aW9uCiAgICBkZXNjcmlwdGlvbjogYmFja3VwIHJl\
dGVudGlvbiBwZXJpb2QKICAgIHR5cGU6IGludAogICAgZGVmYXVsdDogMAogIC0gbmFtZTogZGJf\
ZW5naW5lCiAgICBkZXNjcmlwdGlvbjogZGF0YWJhc2UgZW5naW5lCiAgICB0eXBlOiBzdHJpbmcK\
ICAgIGRlZmF1bHQ6IHBvc3RncmVzCiAgLSBuYW1lOiBkYl9uYW1lCiAgICBkZXNjcmlwdGlvbjog\
bmFtZSBvZiB0aGUgZGF0YWJhc2UgdG8gY3JlYXRlCiAgICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1\
bHQ6IHRlc3RkYgogIC0gbmFtZTogZGJfcGFzc3dvcmQKICAgIGRlc2NyaXB0aW9uOiBtYXN0ZXIg\
cGFzc3dvcmQKICAgIHR5cGU6IHN0cmluZwogICAgZGVmYXVsdDogZGJwYXNzd2QKICAtIG5hbWU6\
IGRiX3NpemUKICAgIGRlc2NyaXB0aW9uOiBzaXplIG9mIHRoZSBkYiBpbiBnYgogICAgdHlwZTog\
aW50CiAgICBkZWZhdWx0OiAxMAogIC0gbmFtZTogZGJfdXNlcm5hbWUKICAgIGRlc2NyaXB0aW9u\
OiBtYXN0ZXIgZGIgdXNlcm5hbWUKICAgIHR5cGU6IHN0cmluZwogICAgZGVmYXVsdDogZGJ1c2Vy\
CiAgLSBuYW1lOiBlbmdpbmVfdmVyc2lvbgogICAgZGVzY3JpcHRpb246IGRiIGVuZ2luZSB2ZXJz\
aW9uCiAgICB0eXBlOiBzdHJpbmcKICAgIGRlZmF1bHQ6IDkuNi4xCiAgLSBuYW1lOiBpbnN0YW5j\
ZV90eXBlCiAgICBkZXNjcmlwdGlvbjogYXdzIGluc3RhbmNlIHR5cGUKICAgIHR5cGU6IHN0cmlu\
ZwogICAgZGVmYXVsdDogZGIubTMubWVkaXVtCiAgLSBuYW1lOiBuYW1lc3BhY2UKICAgIGRlc2Ny\
aXB0aW9uOiBOYW1lc3BhY2UgdG8gZGVwbG95IHRoZSBjbHVzdGVyIHRvCiAgICB0eXBlOiBzdHJp\
bmcKICAgIGRlZmF1bHQ6IGZvcmVtYW4tYW5zaWJsZWFwcAogIC0gbmFtZTogb3BlbnNoaWZ0X3Rh\
cmdldAogICAgZGVzY3JpcHRpb246IHRhcmdldCBvcGVuc2hpZnQgaG9zdHMgdXJsCiAgICB0eXBl\
OiBzdHJpbmcKICAtIG5hbWU6IG9wZW5zaGlmdF91c2VyCiAgICBkZXNjcmlwdGlvbjogb3BlbnNo\
aWZ0IHVzZXIgdG8gYXV0aGVudGljYXRlIGFzCiAgICB0eXBlOiBzdHJpbmcKICAtIG5hbWU6IG9w\
ZW5zaGlmdF9wYXNzCiAgICBkZXNjcmlwdGlvbjogcGFzc3dvcmQgZm9yIHRoZSBvcGVuc2hpZnQg\
dXNlcgogICAgdHlwZTogc3RyaW5nCiAgLSBuYW1lOiBwb3J0CiAgICBkZXNjcmlwdGlvbjogcG9y\
dCB0aGUgZGF0YWJhc2Ugd2lsbCBsaXN0ZW4gb24KICAgIHR5cGU6IGludAogICAgZGVmYXVsdDog\
NTQzMgogIC0gbmFtZTogcmVnaW9uCiAgICBkZXNjcmlwdGlvbjogYXdzIHJlZ2lvbgogICAgdHlw\
ZTogc3RyaW5nCiAgLSBuYW1lOiBzdWJuZXQKICAgIGRlc2NyaXB0aW9uOiB2cGMgc3VibmV0IHRv\
IGRlcGxveSBpbnN0YW5jZSBvbgogICAgdHlwZTogc3RyaW5nCiAgLSBuYW1lOiB2cGNfc2VjdXJp\
dHlfZ3JvdXBzCiAgICBkZXNjcmlwdGlvbjogdnBjIHNlY3VyaXR5IGdyb3VwcyB0byBhc3NpZ24g\
dG8gdGhlIGluc3RhbmNlCiAgICB0eXBlOiBzdHJpbmcK"
RUN yum -y install python-boto bind-utils libselinux-python && yum clean all
ADD ansible /opt/ansible
ADD ansibleapp /opt/ansibleapp

RUN useradd -u 1001 -r -g 0 -M -b /opt/ansibleapp -s /sbin/nologin -c "ansibleapp user" ansibleapp
RUN chown -R 1001:0 /opt/{ansible,ansibleapp}
USER 1001
